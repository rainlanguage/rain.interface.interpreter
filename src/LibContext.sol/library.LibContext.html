<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>LibContext</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../book.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">src</li><li class="chapter-item "><a href="../../src/deployerDiscoverable/index.html">❱ deployerDiscoverable</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../src/deployerDiscoverable/DeployerDiscoverableMetaV1.sol/struct.DeployerDiscoverableMetaV1ConstructionConfig.html">DeployerDiscoverableMetaV1ConstructionConfig</a></li><li class="chapter-item "><a href="../../src/deployerDiscoverable/DeployerDiscoverableMetaV1.sol/abstract.DeployerDiscoverableMetaV1.html">DeployerDiscoverableMetaV1</a></li><li class="chapter-item "><a href="../../src/deployerDiscoverable/LibDeployerDiscoverable.sol/library.LibDeployerDiscoverable.html">LibDeployerDiscoverable</a></li></ol></li><li class="chapter-item "><a href="../../src/deprecated/index.html">❱ deprecated</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../src/deprecated/IInterpreterCallerV1.sol/struct.SignedContext.html">SignedContext</a></li><li class="chapter-item "><a href="../../src/deprecated/IInterpreterCallerV1.sol/interface.IInterpreterCallerV1.html">IInterpreterCallerV1</a></li><li class="chapter-item "><a href="../../src/deprecated/IInterpreterCallerV1.sol/constants.IInterpreterCallerV1.html">IInterpreterCallerV1 constants</a></li></ol></li><li class="chapter-item "><a href="../../src/unstable/index.html">❱ unstable</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../src/unstable/IDebugExpressionDeployerV1.sol/interface.IDebugExpressionDeployerV1.html">IDebugExpressionDeployerV1</a></li><li class="chapter-item "><a href="../../src/unstable/IDebugInterpreterV1.sol/interface.IDebugInterpreterV1.html">IDebugInterpreterV1</a></li></ol></li><li class="chapter-item "><a href="../../src/IExpressionDeployerV1.sol/interface.IExpressionDeployerV1.html">IExpressionDeployerV1</a></li><li class="chapter-item "><a href="../../src/IInterpreterCallerV2.sol/struct.SignedContextV1.html">SignedContextV1</a></li><li class="chapter-item "><a href="../../src/IInterpreterCallerV2.sol/interface.IInterpreterCallerV2.html">IInterpreterCallerV2</a></li><li class="chapter-item "><a href="../../src/IInterpreterCallerV2.sol/constants.IInterpreterCallerV2.html">IInterpreterCallerV2 constants</a></li><li class="chapter-item "><a href="../../src/IInterpreterExternV1.sol/type.EncodedExternDispatch.html">EncodedExternDispatch</a></li><li class="chapter-item "><a href="../../src/IInterpreterExternV1.sol/type.ExternDispatch.html">ExternDispatch</a></li><li class="chapter-item "><a href="../../src/IInterpreterExternV1.sol/interface.IInterpreterExternV1.html">IInterpreterExternV1</a></li><li class="chapter-item "><a href="../../src/IInterpreterStoreV1.sol/type.FullyQualifiedNamespace.html">FullyQualifiedNamespace</a></li><li class="chapter-item "><a href="../../src/IInterpreterStoreV1.sol/interface.IInterpreterStoreV1.html">IInterpreterStoreV1</a></li><li class="chapter-item "><a href="../../src/IInterpreterStoreV1.sol/constants.IInterpreterStoreV1.html">IInterpreterStoreV1 constants</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/type.SourceIndex.html">SourceIndex</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/type.EncodedDispatch.html">EncodedDispatch</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/type.StateNamespace.html">StateNamespace</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/type.Operand.html">Operand</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/interface.IInterpreterV1.html">IInterpreterV1</a></li><li class="chapter-item "><a href="../../src/IInterpreterV1.sol/constants.IInterpreterV1.html">IInterpreterV1 constants</a></li><li class="chapter-item "><a href="../../src/LibContext.sol/error.InvalidSignature.html">InvalidSignature</a></li><li class="chapter-item expanded "><a href="../../src/LibContext.sol/library.LibContext.html" class="active">LibContext</a></li><li class="chapter-item "><a href="../../src/LibEncodedDispatch.sol/library.LibEncodedDispatch.html">LibEncodedDispatch</a></li><li class="chapter-item "><a href="../../src/LibEvaluable.sol/struct.EvaluableConfig.html">EvaluableConfig</a></li><li class="chapter-item "><a href="../../src/LibEvaluable.sol/struct.Evaluable.html">Evaluable</a></li><li class="chapter-item "><a href="../../src/LibEvaluable.sol/library.LibEvaluable.html">LibEvaluable</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rainprotocol/rain.interface.interpreter" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="libcontext"><a class="header" href="#libcontext">LibContext</a></h1>
<p><a href="https://github.com/rainprotocol/rain.interface.interpreter/blob/c5802fe07df3e765aea68e65dc3e1ceffc86a305/src/LibContext.sol">Git Source</a></p>
<p>Conventions for working with context as a calling contract. All of
this functionality is OPTIONAL but probably useful for the majority of use
cases. By building and authenticating onchain, caller provided and signed
contexts all in a standard way the overall usability of context is greatly
improved for expression authors and readers. Any calling contract that can
match the context expectations of an existing expression is one large step
closer to compatibility and portability, inheriting network effects of what
has already been authored elsewhere.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="base"><a class="header" href="#base">base</a></h3>
<p>The base context is the <code>msg.sender</code> and address of the calling contract.
As the interpreter itself is called via an external interface and may be
statically calling itself, it MAY NOT have any ability to inspect either
of these values. Even if this were not the case the calling contract
cannot assume the existence of some opcode(s) in the interpreter that
inspect the caller, so providing these two values as context is
sufficient to decouple the calling contract from the interpreter. It is
STRONGLY RECOMMENDED that even if the calling contract has &quot;no context&quot;
that it still provides this base to every <code>eval</code>.
Calling contracts DO NOT need to call this directly. It is built and
merged automatically into the standard context built by <code>build</code>.</p>
<pre><code class="language-solidity">function base() internal view returns (uint256[] memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256[]</code></td><td>The <code>msg.sender</code> and address of the calling contract using this library, as a context-compatible array.</td></tr>
</tbody></table>
</div>
<h3 id="hash"><a class="header" href="#hash">hash</a></h3>
<p>Standard hashing process over a single <code>SignedContextV1</code>. Notably used
to hash a list as <code>SignedContextV1[]</code> but could also be used to hash a
single <code>SignedContextV1</code> in isolation. Avoids allocating memory by
hashing each struct field in sequence within the memory scratch space.</p>
<pre><code class="language-solidity">function hash(SignedContextV1 memory signedContext) internal pure returns (bytes32 hashed);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>signedContext</code></td><td><code>SignedContextV1</code></td><td>The signed context to hash.</td></tr>
</tbody></table>
</div>
<h3 id="hash-1"><a class="header" href="#hash-1">hash</a></h3>
<p>Standard hashing process over a list of signed contexts. Situationally
useful if the calling contract wants to record that it has seen a set of
signed data then later compare it against some input (e.g. to ensure that
many calls of some function all share the same input values). Note that
unlike the internals of <code>build</code>, this hashes over the signer and the
signature, to ensure that some data cannot be re-signed and used under
a different provenance later.</p>
<pre><code class="language-solidity">function hash(SignedContextV1[] memory signedContexts) internal pure returns (bytes32 hashed);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>signedContexts</code></td><td><code>SignedContextV1[]</code></td><td>The list of signed contexts to hash over.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hashed</code></td><td><code>bytes32</code></td><td>The hash of the signed contexts.</td></tr>
</tbody></table>
</div>
<h3 id="build"><a class="header" href="#build">build</a></h3>
<p>Builds a standard 2-dimensional context array from base, calling and
signed contexts. Note that &quot;columns&quot; of a context array refer to each
<code>uint256[]</code> and each item within a <code>uint256[]</code> is a &quot;row&quot;.</p>
<pre><code class="language-solidity">function build(uint256[][] memory baseContext, SignedContextV1[] memory signedContexts)
    internal
    view
    returns (uint256[][] memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>baseContext</code></td><td><code>uint256[][]</code></td><td>Anything the calling contract can provide which MAY include input from the <code>msg.sender</code> of the calling contract. The default base context from <code>LibContext.base()</code> DOES NOT need to be provided by the caller, this matrix MAY be empty and will be simply merged into the final context. The base context matrix MUST contain a consistent number of columns from the calling contract so that the expression can always predict how many unsigned columns there will be when it runs.</td></tr>
<tr><td><code>signedContexts</code></td><td><code>SignedContextV1[]</code></td><td>Signed contexts are provided by the <code>msg.sender</code> but signed by a third party. The expression (author) defines <em>who</em> may sign and the calling contract authenticates the signature over the signed data. Technically <code>build</code> handles all the authentication inline for the calling contract so if some context builds it can be treated as authentic. The builder WILL REVERT if any of the signatures are invalid. Note two things about the structure of the final built context re: signed contexts: - The first column is a list of the signers in order of what they signed - The <code>msg.sender</code> can provide an arbitrary number of signed contexts so expressions DO NOT know exactly how many columns there are. The expression is responsible for defining e.g. a domain separator in a position that would force signed context to be provided in the &quot;correct&quot; order, rather than relying on the <code>msg.sender</code> to honestly present data in any particular structure/order.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../src/LibContext.sol/error.InvalidSignature.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../src/LibEncodedDispatch.sol/library.LibEncodedDispatch.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../src/LibContext.sol/error.InvalidSignature.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../src/LibEncodedDispatch.sol/library.LibEncodedDispatch.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../solidity.min.js"></script>


    </div>
    </body>
</html>
